create table categoria (id bigint generated by default as identity, nome varchar(255), primary key (id));
create table chat (id bigint generated by default as identity, match_id bigint not null unique, primary key (id));
create table evento_mudanca_status (is_achado_confirmado boolean not null, is_perdido_confirmado boolean not null, tipo_evento_mudanca_status smallint check (tipo_evento_mudanca_status between 0 and 1), id bigint generated by default as identity, match_id bigint, primary key (id));
create table item (data_criacao timestamp(6), data_devolucao timestamp(6), data_evento timestamp(6), id bigint generated by default as identity, usuario_id bigint, descricao varchar(255), localizacao varchar(255), nome varchar(255), status varchar(255) check (status in ('MATCHING','EM_DEVOLUCAO','RECUPERADO')), tipo varchar(255) check (tipo in ('PERDIDO','ACHADO')), primary key (id));
create table item_categoria (categoria_id bigint not null, item_id bigint not null, primary key (categoria_id, item_id));
create table match (arquivado_por_item_achado boolean not null, arquivado_por_item_perdido boolean not null, is_finalizado boolean not null, tipo_finalizacao_match smallint check (tipo_finalizacao_match between 0 and 1), id bigint generated by default as identity, item_achado_id bigint, item_perdido_id bigint, primary key (id), constraint UK_match_itens unique (item_perdido_id, item_achado_id));
create table usuario (id bigint generated by default as identity, email varchar(255), nome varchar(255), senha varchar(255), primary key (id));
create table usuario_chat (chat_id bigint not null, usuario_id bigint not null, primary key (chat_id, usuario_id));
alter table if exists chat add constraint FKtrad2k63ilsmgaeewisq1apj0 foreign key (match_id) references match;
alter table if exists evento_mudanca_status add constraint FKk3omus74qctw6nhxsddv9ram4 foreign key (match_id) references match;
alter table if exists item add constraint FKpmv00mpj3ufvwmkh24x4j6j65 foreign key (usuario_id) references usuario;
alter table if exists item_categoria add constraint FKjb1no42hxqipu6qnbugfj79sf foreign key (categoria_id) references categoria;
alter table if exists item_categoria add constraint FKmsufuwymu3a4fwvablb0kbyok foreign key (item_id) references item;
alter table if exists match add constraint FKfneax8436thf40qb7yqqoggy4 foreign key (item_achado_id) references item;
alter table if exists match add constraint FKhso0rilvvdul3jla5asg7ject foreign key (item_perdido_id) references item;
alter table if exists usuario_chat add constraint FKif606xjtquo8oeockgpoe1tp6 foreign key (usuario_id) references usuario;
alter table if exists usuario_chat add constraint FK6c78mnwaba699213eekniefrb foreign key (chat_id) references chat;
